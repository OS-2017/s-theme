!function(n,e,i){"use strict";n("nav#block-mega ul li a.is-active").parent().addClass("is-active");var s=e.Modernizr,t=n("body");n.DLMenu=function(e,i){this.$el=n(i),this._init(e)},n.DLMenu.defaults={animationClasses:{classin:"dl-animate-in-1",classout:"dl-animate-out-1"},onLevelClick:function(n,e){return!1},onLinkClick:function(n,e){return!1},backLabel:"Back",useActiveItemAsBackLabel:!1,useActiveItemAsLink:!1,resetOnClose:!0},n.DLMenu.prototype={_init:function(e){this.options=n.extend(!0,{},n.DLMenu.defaults,e),this._config();var i={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.animEndEventName=i[s.prefixed("animation")]+".dlmenu",this.transEndEventName=t[s.prefixed("transition")]+".dlmenu",this.supportAnimations=s.cssanimations,this.supportTransitions=s.csstransitions,this._initEvents()},_config:function(){this.open=!1,this.$trigger=this.$el.children(".dl-trigger"),this.$menu=this.$el.children("ul.dl-menu"),this.$menuitems=this.$menu.find("li:not(.dl-back)"),this.$el.find("ul.dl-menu").prepend('<li class="dl-back"><a href="#">&nbsp;</a><a href="#" class="dl-close-link">CLOSE</a></li>'),this.$el.find("ul.dl-submenu").prepend('<li class="dl-back"><a href="#"class="dl-back-link">BACK</a><a href="#" class="dl-close-link">CLOSE</a></li>'),this.$back=this.$menu.find("li a.dl-back-link")},_initEvents:function(){var e=this;this.$trigger.on("click.dlmenu",function(){return e.open?e._closeMenu():(e._openMenu(),n("a.dl-close-link").on("click.dlmenu",function(){e._closeMenu()}),t.off("click").children().on("click.dlmenu",function(){e._closeMenu()})),!1}),this.$menuitems.on("click.dlmenu",function(i){i.stopPropagation();var s=n(this),t=s.children("ul.dl-submenu"),a=n(i.target);if(a.is(".expand")){if(t.length>0&&!n(i.currentTarget).hasClass("dl-subviewopen")){var o=t.clone().css("opacity",0).insertAfter(e.$menu),l=function(){e.$menu.off(e.animEndEventName).removeClass(e.options.animationClasses.classout).addClass("dl-subview"),s.addClass("dl-subviewopen").parents(".dl-subviewopen:first").removeClass("dl-subviewopen").addClass("dl-subview"),o.remove()};return setTimeout(function(){o.addClass(e.options.animationClasses.classin),e.$menu.addClass(e.options.animationClasses.classout),e.supportAnimations?e.$menu.on(e.animEndEventName,l):l.call(),e.options.onLevelClick(s,s.children("span.expand").text())}),!1}e.options.onLinkClick(s,i)}}),this.$back.on("click.dlmenu",function(i){var s=n(this),t=s.parents("ul.dl-submenu:first"),a=t.parent(),o=t.clone().insertAfter(e.$menu),l=function(){e.$menu.off(e.animEndEventName).removeClass(e.options.animationClasses.classin),o.remove()};return setTimeout(function(){o.addClass(e.options.animationClasses.classout),e.$menu.addClass(e.options.animationClasses.classin),e.supportAnimations?e.$menu.on(e.animEndEventName,l):l.call(),a.removeClass("dl-subviewopen");var n=s.parents(".dl-subview:first");n.is("li")&&n.addClass("dl-subviewopen"),n.removeClass("dl-subview")}),!1})},closeMenu:function(){this.open&&this._closeMenu()},_closeMenu:function(){var n=this,e=function(){n.$menu.off(n.transEndEventName),n.options.resetOnClose&&n._resetMenu()};this.$menu.removeClass("dl-menuopen"),this.$menu.addClass("dl-menu-toggle"),this.$trigger.removeClass("dl-active"),this.$trigger.parent(".dl-menuwrapper").css("height","0"),this.$trigger.parent().siblings(".overlay-container").hide(),this.supportTransitions?this.$menu.on(this.transEndEventName,e):e.call(),this.open=!1},openMenu:function(){this.open||this._openMenu()},_openMenu:function(){var e=this;n("a.dl-close-link").on("click.dlmenu",function(){e._closeMenu()}),t.off("click").on("click.dlmenu",function(){e._closeMenu()}),this.$trigger.parent().siblings(".overlay-container").show(),this.$trigger.parent(".dl-menuwrapper").css("height","auto"),this.$menu.addClass("dl-menuopen dl-menu-toggle").on(this.transEndEventName,function(){n(this).removeClass("dl-menu-toggle")}),this.$trigger.addClass("dl-active"),this.open=!0,n("#dl-menu").find("li.active-trail").length&&(n("#dl-menu ul.dl-menu").addClass("dl-subview"),n("li.active-trail").addClass("dl-subview"),n("a.active").parent().removeClass("dl-subview").parent().parent().removeClass("dl-subview").addClass("dl-subviewopen"))},_resetMenu:function(){this.$menu.removeClass("dl-subview"),this.$menuitems.removeClass("dl-subview dl-subviewopen")}};var a=function(n){e.console&&e.console.error(n)};n.fn.dlmenu=function(e){if("string"==typeof e){var i=Array.prototype.slice.call(arguments,1);this.each(function(){var s=n.data(this,"dlmenu");return s?n.isFunction(s[e])&&"_"!==e.charAt(0)?void s[e].apply(s,i):void a("no such method '"+e+"' for dlmenu instance"):void a("cannot call methods on dlmenu prior to initialization; attempted to call method '"+e+"'")})}else this.each(function(){var i=n.data(this,"dlmenu");i?i._init():i=n.data(this,"dlmenu",new n.DLMenu(e,this))});return this}}(jQuery,window);